<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recupera tu contraseña | Decode</title>
    <link rel="stylesheet" href="assets/styles/styles.css">
    
    <link rel="stylesheet" href="assets/styles/style-recover.css">
    <script src="https://kit.fontawesome.com/350b7ab1bf.js" crossorigin="anonymous"></script>
</head>
<body>
<header class="header">
    <section class="header__logo">
        <img src="assets/icons/logo.png" alt="" srcset="">
        <div class="header__title">
            <h2 class="header__title-main">Decode</h2>
            <p class="header__title-sub">SmartSolutions</p>
        </div>
    </section>

    <button class="header__menu-btn" id="menu-toggle">
        <i class="fas fa-bars"></i>
    </button>

    <section class="header__interaction">
        <nav class="header__nav">
            <a href="index.html" class="header__nav-link">Inicio</a>
            <a href="comunidad.html" class="header__nav-link">Comunidad</a>
            <a href="#" class="header__nav-link">Sobre nosotros</a>
            <a href="#" class="header__nav-link">Suscripciones</a>
        </nav>

        <div class="header__actions">
            <input type="button" value="Iniciar Sesión" class="btn btn--primary header__btn-login" onclick="window.location.href='login.html'">
            <input type="button" value="Empieza gratis" class="btn btn--secondary header__btn-register" onclick="window.location.href='register.html'">
        </div>
    </section>

    <div class="header__overlay-menu" id="header-overlay">
        <div class="header__overlay-content">
            <button class="header__close-btn" id="menu-close">
                <i class="fas fa-times"></i>
            </button>
            <a href="index.html" class="header__overlay-link">Inicio</a>
            <a href="comunidad.html" class="header__overlay-link">Comunidad</a>
            <a href="#" class="header__overlay-link">Sobre nosotros</a>
            <a href="#" class="header__overlay-link">Suscripciones</a>
            <div style="margin-top: 20px; display: flex; flex-direction: column; gap: 10px; width: 100%;">
                <input type="button" value="Iniciar Sesión" class="btn btn--primary" onclick="window.location.href='login.html'" style="width: 100%;">
                <input type="button" value="Empieza gratis" class="btn btn--secondary" onclick="window.location.href='register.html'" style="width: 100%;">
            </div>
        </div>
    </div>
</header>

    <section class="sesion">
        <div class="recover">
            <div class="recover__info" style="text-align: center;">
                <img src="assets/icons/mail.svg" alt="Correo" style="filter: contrast()">
                <h2>Restablecer contraseña</h2>
            </div>

            <form class="recover-form">
                <div id="step1">
                    <div class="recover__input">
                        <p style="text-align: center;">Ingrese su correo para enviar un código de verificación</p>
                        <input type="email" id="rec__email" name="email" required>
                        <p id="rec__email-error" style="color:rgb(202, 17, 17); display:none;">
                            No existe una cuenta con ese correo.
                        </p>
                    </div>

                    <div class="recover__enter">
                        <button type="button" class="btn" id="btn__ingresar-correo">Ingresar correo</button>
                        <p><a href="login.html">Volver a iniciar sesión</a></p>
                    </div>
                </div>

                <div id="step2" style="display:none;">
                    <div class="recover__input">
                        <p>Ingresa tu código de verificación</p>
                        <input type="text" id="rec__codigo" name="codigo" required>
                        <p id="rec__codigo-error" style="color:rgb(202, 17, 17); display:none;">
                            Código incorrecto. El código de prueba es 123.
                        </p>
                    </div>

                    <div class="recover__enter">
                        <button type="button" class="btn" id="btn__verificar-codigo">Verificar código</button>
                    </div>
                </div>

                <div id="step3" style="display:none;">
                    <div class="recover__input">
                        <p>Ingrese su nueva contraseña</p>
                        <input type="password" id="rec__pass1" name="nueva_pass" required>
                    </div>

                    <div class="recover__input">
                        <p>Confirmar nueva contraseña</p>
                        <input type="password" id="rec__pass2" name="confirmar_pass" required>
                        <p id="rec__pass-error" style="color:rgb(202, 17, 17); display:none;">
                            Las contraseñas no coinciden o están vacías.
                        </p>
                    </div>

                    <div class="recover__enter">
                        <button type="button" class="btn" id="btn__actualizar-pass">Actualizar contraseña</button>
                    </div>
                </div>

                <div id="step4" style="display:none;">
                    <p style="margin-top: 1.5rem; text-align:center;">
                        Tu contraseña ha sido actualizada correctamente.
                    </p>
                    <div class="recover__enter">
                        <a href="login.html" class="btn" style="
                            text-align:center;
                            display:block;
                            padding-top:10px;
                            text-decoration:none;
                        ">
                            Ir a iniciar sesión
                        </a>
                    </div>
                </div>

            </form>
        </div>
    </section>
<script src="./assets/scripts/app.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        // Lógica del Menú Hamburguesa
        const menuToggle = document.getElementById("menu-toggle");
        const menuClose = document.getElementById("menu-close");
        const overlay = document.getElementById("header-overlay");

        if (menuToggle && overlay) {
            menuToggle.addEventListener("click", () => {
                overlay.classList.add("header__overlay-menu--active");
            });
        }

        if (menuClose && overlay) {
            menuClose.addEventListener("click", () => {
                overlay.classList.remove("header__overlay-menu--active");
            });
        }

        if (overlay) {
            overlay.addEventListener("click", (e) => {
                if (e.target === overlay) {
                    overlay.classList.remove("header__overlay-menu--active");
                }
            });
        }


        const form = document.querySelector(".login-form");
        if(form){
            form.addEventListener("submit", function(e) {
                e.preventDefault();
                const email = document.getElementById("li__email").value;
                const pass = document.getElementById("li__contraseña").value;
                const msgCuenta = document.getElementById("cuenta__equivocada");

                const usuarios = JSON.parse(localStorage.getItem("usuarios")) || [];
                const encontrado = usuarios.find(u => u.email === email && u.contraseña === pass);

                if (encontrado) {
                    localStorage.setItem("usuarioActual", JSON.stringify(encontrado));
                    msgCuenta.style.display = "none";
                    window.location.href = "home.html";
                } else {
                    msgCuenta.style.display = "block";
                }
            });
        }
    });
</script>
</body>
</html>
